/*! DirtyForm v0.4.0 | MIT License */
!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(e="undefined"!=typeof globalThis?globalThis:e||self).DirtyForm=i()}(this,(function(){"use strict";return class{constructor(e,i={}){this.form=e,this.isDirty=!1,this.initialValues={},this.fields=[...this.form.elements,...this.form.querySelectorAll("trix-editor")],this.message=i.message||"You have unsaved changes!",this.setupFields(),this.setFormHandlers()}setupFields(){this.fields.forEach((e=>{e.name&&"submit"!=e.type&&"button"!=e.type&&"hidden"!=e.type&&(this.initialValues[e.name]=e.value,"TRIX-EDITOR"==e.nodeName?e.addEventListener("trix-change",this.checkValue.bind(this)):(e.addEventListener("change",this.checkValue.bind(this)),e.addEventListener("input",this.checkValue.bind(this))))}))}setFormHandlers(){window.addEventListener("submit",this.handleSubmit.bind(this)),this.form.addEventListener("submit",this.handleSubmit.bind(this)),window.onbeforeunload=()=>{if(this.isDirty)return this.message},"undefined"!=typeof Turbolinks&&document.addEventListener("turbolinks:before-visit",(e=>{this.isDirty&&!confirm(this.message)?e.preventDefault():this.isDirty=!1}))}checkValue(e){let i=e.target;this.initialValues[i.name]!=i.value&&(this.isDirty=!0)}handleSubmit(){this.isDirty=!1}}}));
